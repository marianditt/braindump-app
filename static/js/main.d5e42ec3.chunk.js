(this["webpackJsonpbraindump-app"]=this["webpackJsonpbraindump-app"]||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(11),c=n.n(a),u=n(53),i=n(14),o=n(10),s=n(18),l=n(48),d=n.n(l),j=n(61),b=n(17),f=n(179),p=n(76),m="dumps";function v(e){var t=JSON.stringify(e);window.localStorage.setItem(m,t)}var O="SET_DUMPS",h="ADD_DUMP",x="UPDATE_DUMP",g="REMOVE_DUMP";function y(e){var t={type:O,dumps:e};return function(e,n){e(t),v(n())}}function D(e){var t={type:g,dump:e};return function(e,n){e(t),v(n())}}var C=function(){var e=window.localStorage.getItem(m);if(null===e)return[];try{return JSON.parse(e).dumps}catch(t){return[]}}();var k=n(33),S=Object(f.c)(Object(f.b)({dumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;function n(e){return Object(o.a)(e)}function r(e,t){return[].concat(Object(o.a)(e),[t])}function a(e,t){var n=e.findIndex((function(e){return e.id===t.id}));if(n<0)return e;var r=Object(o.a)(e);return r[n]=t,r}function c(e,t){return e.filter((function(e){return e.id!==t.id}))}switch(t.type){case O:var u=t;return n(u.dumps);case h:var i=t;return r(e,i.dump);case x:var s=t;return a(e,s.dump);case g:var l=t;return c(e,l.dump)}return e}}),Object(f.a)(p.a)),w=k.c,N=function(){return Object(k.b)()};function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object.keys(t.map((function(e){return e.replace("'","")})).map((function(e){return e.toLowerCase()})).flatMap((function(e){return e.split(/[^a-z0-9]/)})).filter((function(e){return e.length>0})).reduce((function(e,t){return e[t]=!0,e}),{}))}var P,B=n(162),T=n(181),I=n(163),F=n(164),M=n(161),R=n(19),L=n(153),A=n(156),U=n(157),H=n(158),J=n(159),_=n(180),W=n(160),K=n(20),V=n(2),z=Object(_.a)(Object(K.b)(q)(P||(P=Object(R.a)([""]))));function q(e){return Object(V.jsx)(W.a,{className:e.className,disabled:e.disabled,onClick:e.onClick,edge:e.edge,color:"inherit","aria-label":e.action,children:function(){switch(e.action){case"back":return Object(V.jsx)(L.a,{});case"cancel":return Object(V.jsx)(A.a,{});case"delete":return Object(V.jsx)(U.a,{});case"edit":return Object(V.jsx)(H.a,{});case"save":return Object(V.jsx)(J.a,{});default:return null}}()})}function G(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),a=n[0],c=n[1];function u(t){e.onChange(t),c(t)}return Object(V.jsxs)(B.a,{children:[Object(V.jsx)(T.a,{htmlFor:"search",children:"Search"}),Object(V.jsx)(I.a,{id:"search",value:a,onChange:function(e){return u(e.target.value)},endAdornment:Object(V.jsx)(F.a,{position:"end",children:""===a?Object(V.jsx)(M.a,{}):Object(V.jsx)(z,{action:"cancel",onClick:function(){return u("")},edge:"end"})}),autoFocus:!0,autoComplete:"off"})]})}q.defaultProps={disabled:!1,onClick:function(){}};var Q,X=n(118),Y=n(165),Z=n(166),$=n(167),ee=Object(_.a)(Object(K.b)((function(e){var t=e.dumps.map((function(t){return Object(V.jsxs)(X.a,{button:!0,onClick:function(){return e.onDumpSelection(t)},children:[Object(V.jsx)(Y.a,{primary:t.summary,secondary:new Date(t.timestamp).toLocaleString()}),Object(V.jsx)(Z.a,{onClick:function(){return e.onDumpRemoval(t)},children:Object(V.jsx)(W.a,{edge:"end","aria-label":"delete",children:Object(V.jsx)(U.a,{})})})]},t.id)}));return Object(V.jsx)($.a,{children:t})}))(Q||(Q=Object(R.a)([""]))));var te,ne=n(168),re=n(169),ae=n(57),ce=Object(_.a)(Object(K.b)((function(e){return Object(V.jsx)(ne.a,{className:e.className,position:"sticky",children:Object(V.jsxs)(re.a,{children:[e.primaryButton,Object(V.jsx)(ae.a,{variant:"h6",children:e.title}),e.secondaryButton]})})}))(te||(te=Object(R.a)(["\n  flex-grow: 1;\n\n  & > div > h6 {\n    flex-grow: 1;\n  }\n"]))));var ue,ie=n(170),oe=n(90),se=n(171),le=Object(_.a)(Object(K.b)((function(e){var t=Object(r.useState)(null),n=Object(b.a)(t,2),a=n[0],c=n[1],u=function(){c(null)},i=e.actions.map((function(e,t){return Object(V.jsx)(ie.a,{onClick:function(){return(0,e.action)(),void u()},children:e.title},"menu-item-".concat(t))}));return Object(V.jsxs)("div",{className:e.className,children:[Object(V.jsx)(W.a,{onClick:function(e){c(e.currentTarget)},edge:"start",color:"inherit","aria-label":"menu",children:Object(V.jsx)(se.a,{})}),i.length>0&&Object(V.jsx)(oe.a,{id:"app-menu",anchorEl:a,keepMounted:!0,open:!!a,onClose:u,children:i})]})}))(ue||(ue=Object(R.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function de(e){return je.apply(this,arguments)}function je(){return(je=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return be(t,e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t){var n=new FileReader;n.onload=function(){var e=function(e){if(null===e)return"";if(e instanceof ArrayBuffer)return(new TextDecoder).decode(e);return e}(n.result),r=JSON.parse(e);t(r)},n.readAsText(e)}var fe,pe=n(172),me=n(173),ve=Object(_.a)(Object(K.b)(Oe)(fe||(fe=Object(R.a)(["\n  position: fixed;\n  top: auto;\n  bottom: ","px;\n  left: auto;\n  right: 30px;\n"])),(function(e){return 30+70*(e.index||0)})));function Oe(e){return Object(V.jsx)(pe.a,{className:e.className,color:"primary","aria-label":"add",onClick:e.onClick,children:Object(V.jsx)(me.a,{})})}Oe.defaultProps={onClick:function(){}};var he=n(174);function xe(){var e=Object(i.f)(),t=Object(r.useCallback)((function(t){"/"===e.location.pathname?e.push(t):e.replace(t)}),[e]);return{navigateHome:Object(r.useCallback)((function(){t("/")}),[t]),navigateToDetails:Object(r.useCallback)((function(e){t("/show/dumps/".concat(e.id))}),[t]),navigateToCreate:Object(r.useCallback)((function(){t("/create")}),[t]),navigateToEdit:Object(r.useCallback)((function(e){t("/edit/dumps/".concat(e.id))}),[t])}}function ge(e){var t=e.useNavigation(),n=Object(r.useState)({filter:"",selected:null}),a=Object(b.a)(n,2),c=a[0],u=a[1],i=w((function(e){var t=e.dumps.map((function(e){return function(e,t){var n=E.apply(void 0,[e.summary,e.description].concat(Object(o.a)(e.tags))),r=E(t);return function(e,t){var n=e.join(";");return t.filter((function(e){return n.includes(e)})).length}(n,r)}(e,c.filter)}));return function(e,t){var n=Math.max.apply(Math,Object(o.a)(t));if(0===n)return[];return t.map((function(e,t){return e===n?t:-1})).filter((function(e){return e>=0})).map((function(t){return e[t]}))}(e.dumps,t)})),l=Object(k.b)(),f=Object(r.useRef)(null),p=function(){var e=Object(j.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=(null===(n=t.target.files)||void 0===n?void 0:n[0])||null)){e.next=6;break}return e.next=4,de(r);case 4:a=e.sent,l(y(a.dumps));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=[{title:"Export",action:function(){!function(e){var t=JSON.stringify(e),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.download="braindump.json",a.href=r,a.click()}(S.getState())}},{title:"Import",action:function(){var e;null===(e=f.current)||void 0===e||e.click()}}];return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ce,{title:"Braindump",primaryButton:Object(V.jsx)(le,{actions:m})}),Object(V.jsx)("input",{type:"file",ref:f,accept:"application/json, .json",onChange:p,style:{display:"none"}}),Object(V.jsxs)(he.a,{maxWidth:!1,children:[Object(V.jsx)("h1",{children:"Find dumps"}),Object(V.jsx)(G,{onChange:function(e){u((function(t){return Object(s.a)(Object(s.a)({},t),{},{filter:e})}))}}),i.length>0&&Object(V.jsx)(ee,{dumps:i,onDumpSelection:t.navigateToDetails,onDumpRemoval:function(e){l(D(e))}}),Object(V.jsx)(ve,{onClick:t.navigateToCreate})]})]})}ge.defaultProps={useNavigation:xe};var ye=n(7);function De(e){return 0===e.trim().length}var Ce=n(178);var ke,Se=n(177),we=[["(",")"],["[","]"],["{","}"],["<",">"],['"','"'],["'","'"]];function Ne(e,t,n){return[e.slice(0,t),e.slice(t,n),e.slice(n)]}function Ee(e){var t=Object(r.useRef)(),n=Object(r.useState)(Pe({value:e.value})),a=Object(b.a)(n,2),c=a[0],u=a[1];function i(t){u(t),e.onChange(t.value)}return Object(r.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.setSelectionRange(c.start,c.end,c.direction)}),[c]),Object(V.jsx)(Se.a,{inputRef:t,label:e.label,value:c.value,onKeyDown:function(t){var n=Pe(t.target),r=e.enhancers.reduce((function(e,r){return e||r(t.key,n)}),null);null!==r&&(i(r),t.stopPropagation(),t.preventDefault())},onChange:function(e){return i(Pe(e.target))},error:!!e.error,helperText:e.error||"",variant:"outlined",multiline:e.multiline})}function Pe(e){return{value:e.value||"",start:e.selectionStart||0,end:e.selectionEnd||0,direction:e.selectionDirection||"none"}}Ee.defaultProps={label:"",value:"",onChange:function(){},error:null,multiline:!1,enhancers:[function(e,t){if("Backspace"!==e||t.start!==t.end)return null;var n=Ne(t.value,t.start-1,t.start+1),r=Object(b.a)(n,3),a=r[0],c=r[1],u=r[2];return we.some((function(e){return e[0]===c[0]&&e[1]===c[1]}))?{value:a+u,start:a.length,end:a.length,direction:t.direction}:null},function(e,t){var n=t.value[t.start];return e!==n||t.start!==t.end?null:we.some((function(e){return e[1]===n}))?{value:t.value,start:t.start+1,end:t.end+1,direction:t.direction}:null},function(e,t){var n=we.find((function(t){return t[0]===e}))||null;if(null===n)return null;var r=Ne(t.value,t.start,t.end),a=Object(b.a)(r,3),c=a[0],u=a[1],i=a[2];return{value:c+n[0]+u+n[1]+i,start:c.length+1,end:c.length+1+u.length,direction:t.direction}}]};var Be=Object(_.a)(Object(K.b)((function(e){var t,n,a=e.dump,c=e.onChange,u={summary:{value:(null===(t=e.dump)||void 0===t?void 0:t.summary)||null,error:null},description:{value:(null===(n=e.dump)||void 0===n?void 0:n.description)||null,error:null}},i=Object(r.useState)(u),o=Object(b.a)(i,2),l=o[0],d=o[1];function j(e,t){var n=De(t),r=n?"Field must not be empty":null;d((function(a){return Object(s.a)(Object(s.a)({},a),{},Object(ye.a)({},e,{value:t,hasError:n,error:r}))}))}return Object(r.useEffect)((function(){var e=(null===a||void 0===a?void 0:a.id)||null,t=l.summary.value||"",n=l.description.value||"";c(function(e,t,n){return{id:e||Object(Ce.a)(),timestamp:Date.now(),summary:t.trim(),description:n,tags:[]}}(e,t,n))}),[l,null===a||void 0===a?void 0:a.id,c]),Object(V.jsxs)("form",{className:e.className,noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault()},children:[Object(V.jsx)("div",{children:Object(V.jsx)(Ee,{label:"Summary",value:l.summary.value||"",onChange:function(e){return j("summary",e)},error:l.summary.error})}),Object(V.jsx)("div",{children:Object(V.jsx)(Ee,{label:"Description",value:l.description.value||"",onChange:function(e){return j("description",e)},error:l.description.error,multiline:!0})})]})}))(ke||(ke=Object(R.a)(["\n  div {\n    width: 100%;\n  }\n\n  > div {\n    margin: ",";\n  }\n\n  > div > div > div > TextArea {\n    font-family: monospace;\n  }\n"])),(function(e){return e.theme.spacing(2,0,2)})));function Te(e){Ie((function(e){return"Escape"===e.key}),e)}function Ie(e,t){function n(n){e(n)&&(t(),n.preventDefault())}Object(r.useEffect)((function(){return document.addEventListener("keydown",n),function(){document.removeEventListener("keydown",n)}}))}var Fe,Me=n(89),Re=Object(_.a)(Object(K.b)((function(e){return Object(V.jsxs)("div",{className:e.className,children:[Object(V.jsx)("h1",{children:e.dump.summary}),Object(V.jsx)(Me.a,{children:e.dump.description})]})}))(Fe||(Fe=Object(R.a)(["\n  > div:last-child {\n    text-align: right;\n  }\n"]))));function Le(e){var t=e.useNavigation(),n=e.useEditorState((null===e||void 0===e?void 0:e.selectedDump)||null),r=Object(b.a)(n,2),a=r[0],c=r[1];function u(){a.saveDisabled||null===a.changedDump||e.onSave(a.changedDump)}return Te(t.navigateHome),Ie((function(e){return e.ctrlKey&&"s"===e.key}),u),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ce,{title:"Braindump",primaryButton:Object(V.jsx)(z,{action:"cancel",onClick:t.navigateHome,edge:"start"}),secondaryButton:Object(V.jsx)(z,{action:"save",disabled:a.saveDisabled,onClick:u,edge:"end"})}),Object(V.jsxs)(he.a,{maxWidth:!1,children:[Object(V.jsx)("h1",{children:e.title}),Object(V.jsx)(Be,{dump:a.selectedDump,onChange:c}),null!==a.changedDump&&Object(V.jsx)(Re,{dump:a.changedDump}),null!==a.selectedDump&&Object(V.jsx)(ve,{onClick:t.navigateToCreate})]})]})}function Ae(e){var t=e.useNavigation(),n=e.useDispatch();return Object(V.jsx)(Le,{title:"Create new dump",onSave:function(e){n(function(e){var t={type:h,dump:e};return function(e,n){e(t),v(n())}}(e)),t.navigateToEdit(e)}})}function Ue(e){return w((function(t){return t.dumps.find((function(t){return t.id===e}))||null}))}function He(e){var t=e.useDumpParam(),n=e.useNavigation(),r=e.useDumpByIdSelector(t.dumpId),a=e.useDispatch();function c(){null!==r&&n.navigateToEdit(r)}return Te(n.navigateHome),Ie((function(e){return"e"===e.key}),c),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ce,{title:"Braindump",primaryButton:Object(V.jsx)(z,{action:"back",onClick:n.navigateHome,edge:"start"}),secondaryButton:Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(z,{action:"edit",disabled:null===r,onClick:c,edge:"end"}),Object(V.jsx)(z,{action:"delete",disabled:null===r,onClick:function(){null!==r&&(a(D(r)),n.navigateHome())},edge:"end"})]})}),Object(V.jsxs)(he.a,{maxWidth:!1,children:[null!==r&&Object(V.jsx)(Re,{dump:r}),Object(V.jsx)(ve,{onClick:n.navigateToCreate})]})]})}function Je(e){var t=e.useDumpParam(),n=e.useDumpByIdSelector(t.dumpId),r=e.useDispatch();return Object(V.jsx)(Le,{title:"Edit dump",selectedDump:n,onSave:function(e){r(function(e){var t={type:x,dump:e};return function(e,n){e(t),v(n())}}(e))}})}function _e(){return Object(V.jsx)(u.a,{basename:"/braindump-app",children:Object(V.jsxs)(i.c,{children:[Object(V.jsx)(i.a,{path:"/create",children:Object(V.jsx)(Ae,{})}),Object(V.jsx)(i.a,{path:"/edit/dumps/:dumpId",children:Object(V.jsx)(Je,{})}),Object(V.jsx)(i.a,{path:"/show/dumps/:dumpId",children:Object(V.jsx)(He,{})}),Object(V.jsx)(i.a,{path:"/",children:Object(V.jsx)(ge,{})})]})})}Le.defaultProps={useNavigation:xe,useEditorState:function(e){var t=Object(r.useState)({selectedDump:e,changedDump:e,saveDisabled:!0}),n=Object(b.a)(t,2),a=n[0],c=n[1];function u(e,t){var n=!De(t.summary),r=!De(t.description),a=t.summary.trim()!==(null===e||void 0===e?void 0:e.summary),c=t.description!==(null===e||void 0===e?void 0:e.description);return n&&r&&(a||c)}return Object(r.useEffect)((function(){c({selectedDump:e,changedDump:e,saveDisabled:!0})}),[e]),[a,Object(r.useCallback)((function(e){c((function(t){return Object(s.a)(Object(s.a)({},t),{},{changedDump:e,saveDisabled:!u(t.selectedDump,e)})}))}),[])]}},Ae.defaultProps={useNavigation:xe,useDispatch:N},He.defaultProps={useDumpParam:function(){return Object(i.g)()},useNavigation:xe,useDumpByIdSelector:Ue,useDispatch:function(){return Object(k.b)()}},Je.defaultProps={useDumpParam:function(){return Object(i.g)()},useDumpByIdSelector:Ue,useDispatch:N};var We,Ke,Ve,ze=n(175),qe=n(176),Ge=Object(K.a)(We||(We=Object(R.a)([""])));c.a.render((Ke=Object(V.jsx)(_e,{}),Object(V.jsxs)(r.StrictMode,{children:[Object(V.jsx)(ze.a,{}),Object(V.jsxs)(qe.b,{injectFirst:!0,children:[Object(V.jsx)(Ge,{}),Object(V.jsx)(k.a,{store:S,children:Ke})]})]})),document.getElementById("root")),Ve&&n.e(3).then(n.bind(null,182)).then((function(e){var t=e.getCLS,n=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;t(Ve),n(Ve),r(Ve),a(Ve),c(Ve)}))}},[[117,1,2]]]);
//# sourceMappingURL=main.d5e42ec3.chunk.js.map