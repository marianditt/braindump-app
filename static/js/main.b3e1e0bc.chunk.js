(this["webpackJsonpbraindump-app"]=this["webpackJsonpbraindump-app"]||[]).push([[0],{118:function(e,n,t){"use strict";t.r(n);var r=t(177),a=t(178),c=t(0),u=t(11),i=t.n(u),o=t(42),s=t(53),l=t(14);function d(){var e=Object(l.f)(),n=Object(c.useCallback)((function(n){"/"===e.location.pathname?e.push(n):e.replace(n)}),[e]);return{navigateHome:Object(c.useCallback)((function(){n("/")}),[n]),navigateToDetails:Object(c.useCallback)((function(e){n("/show/dumps/".concat(e.id))}),[n]),navigateToCreate:Object(c.useCallback)((function(){n("/create")}),[n]),navigateToEdit:Object(c.useCallback)((function(e){n("/edit/dumps/".concat(e.id))}),[n])}}var j,p="dumps";function m(e){var n=JSON.stringify(e);window.localStorage.setItem(p,n)}function f(e){var n={type:j.MergeDumps,dumps:e};return function(e,t){e(n),m(t())}}function b(e){return v(j.RemoveDump,e)}function v(e,n){var t={type:e,dump:n};return function(e,n){e(t),m(n())}}!function(e){e.MergeDumps="MergeDumps",e.AddDump="AddDump",e.UpdateDump="UpdateDump",e.RemoveDump="RemoveDump"}(j||(j={}));var O=t(181),h=t(80),g=t(15),x=t(10),y=function(){var e=window.localStorage.getItem(p);if(null===e)return[];try{return JSON.parse(e).dumps}catch(n){return[]}}();function D(e,n){if(null===e)return n;var t=function(e,n){return e===n?[e,!1]:["".concat(e," --- ").concat(n),!0]}(e.summary,n.summary),r=Object(g.a)(t,2),a=r[0],c=r[1],u=function(e,n){return e===n?[e,!1]:["".concat(e,"\n\n---\n\n").concat(n),!0]}(e.description,n.description),i=Object(g.a)(u,2),o=i[0],s=i[1],l=c||s?"CONFLICT: ":"",d=new Map;return e.tags.forEach((function(e){return d.set(e,!0)})),n.tags.forEach((function(e){return d.set(e,!0)})),{id:e.id,summary:l+a,description:o,tags:Array.from(d.keys()),timestamp:Math.min(e.timestamp,n.timestamp)}}var C=Object(O.c)(Object(O.b)({dumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,n=arguments.length>1?arguments[1]:void 0;function t(n){var t=new Map;return e.forEach((function(e){return t.set(e.id,e)})),n.forEach((function(e){return t.set(e.id,D(t.get(e.id)||null,e))})),Array.from(t.values())}function r(e,n){return[].concat(Object(x.a)(e),[n])}function a(e,n){var t=e.findIndex((function(e){return e.id===n.id}));if(t<0)return e;var r=Object(x.a)(e);return r[t]=n,r}function c(e,n){return e.filter((function(e){return e.id!==n.id}))}switch(n.type){case j.MergeDumps:var u=n;return t(u.dumps);case j.AddDump:var i=n;return r(e,i.dump);case j.UpdateDump:var o=n;return a(e,o.dump);case j.RemoveDump:var s=n;return c(e,s.dump)}return e}}),Object(O.a)(h.a)),k=o.c,w=function(){return Object(o.b)()},S=t(20);function N(e){return 0===e.trim().length}function E(e){B((function(e){return"Escape"===e.key}),e)}function B(e,n){function t(t){e(t)&&(n(),t.preventDefault())}Object(c.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}))}var F,P,T=t(18),I=t(182),R=t(153),M=t(156),A=t(57),L=t(19),H=t(90),J=t(2),U=Object(I.a)(Object(L.b)((function(e){return Object(J.jsx)(H.a,{className:e.className,children:e.content})}))(F||(F=Object(T.a)(["\n  ",";\n\n  h1 {\n    ",";\n  }\n\n  h2 {\n    ",";\n  }\n\n  h3,\n  h4,\n  h5,\n  h6 {\n    ",";\n  }\n\n  img {\n    max-width: 100%;\n    max-height: 50vh;\n  }\n\n  *:not(pre) > code,\n  pre {\n    border: solid thin #d3d3d3;\n    border-radius: 5px;\n    background-color: #efefef;\n  }\n\n  *:not(pre) > code {\n    padding: 3px;\n  }\n\n  pre {\n    padding: ",";\n  }\n"])),(function(e){return e.theme.typography}),(function(e){return e.theme.typography.h4}),(function(e){return e.theme.typography.h5}),(function(e){return e.theme.typography.h6}),(function(e){return e.theme.spacing(1,1,1,1)})));var K=Object(I.a)(Object(L.b)((function(e){return Object(J.jsx)(R.a,{className:e.className,children:Object(J.jsxs)(M.a,{children:[Object(J.jsx)(A.a,{variant:"h6",children:e.dump.summary}),Object(J.jsx)(U,{content:e.dump.description})]})})}))(P||(P=Object(T.a)(["\n  margin: ",";\n"])),(function(e){return e.theme.spacing(2,0,2)})));var z=t(7),V=t(180);var W,q=t(179),G=function(){var e=new Map;return e.set("(",")"),e.set("[","]"),e.set("{","}"),e.set("<",">"),e.set('"','"'),e.set("'","'"),e}(),Q=function(e){var n=new Map;return e.forEach((function(e,t){return n.set(e,t)})),n}(G);function X(e,n,t){return[e.slice(0,n),e.slice(n,t),e.slice(t)]}function Y(e){var n=Object(c.useRef)(),t=Object(c.useState)(Z({value:e.value})),r=Object(g.a)(t,2),a=r[0],u=r[1];function i(n){u(n),e.onChange(n.value)}return Object(c.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.setSelectionRange(a.start,a.end,a.direction)}),[a]),Object(J.jsx)(q.a,{inputRef:n,label:e.label,value:a.value,onKeyDown:function(n){var t=Z(n.target),r=e.enhancers.reduce((function(e,r){return e||r(n.key,t)}),null);null!==r&&(i(r),n.stopPropagation(),n.preventDefault())},onChange:function(e){return i(Z(e.target))},error:!!e.error,helperText:e.error||"",variant:"outlined",multiline:e.multiline})}function Z(e){return{value:e.value||"",start:e.selectionStart||0,end:e.selectionEnd||0,direction:e.selectionDirection||"none"}}Y.defaultProps={label:"",value:"",onChange:function(){},error:null,multiline:!1,enhancers:[function(e,n){if("Backspace"!==e||n.start!==n.end)return null;var t=X(n.value,n.start-1,n.start+1),r=Object(g.a)(t,3),a=r[0],c=r[1],u=r[2];return!!G.get(c[0])&&!!Q.get(c[1])?{value:a+u,start:a.length,end:a.length,direction:n.direction}:null},function(e,n){var t=n.value[n.start];return e!==t||n.start!==n.end?null:!!Q.get(t)?{value:n.value,start:n.start+1,end:n.end+1,direction:n.direction}:null},function(e,n){var t=G.get(e)||null;if(null===t)return null;var r=X(n.value,n.start,n.end),a=Object(g.a)(r,3),c=a[0],u=a[1];return{value:c+e+u+t+a[2],start:c.length+1,end:c.length+1+u.length,direction:n.direction}}]};var $=Object(I.a)(Object(L.b)((function(e){var n,t,r=e.dump,a=e.onChange,u={summary:{value:(null===(n=e.dump)||void 0===n?void 0:n.summary)||null,error:null},description:{value:(null===(t=e.dump)||void 0===t?void 0:t.description)||null,error:null}},i=Object(c.useState)(u),o=Object(g.a)(i,2),s=o[0],l=o[1];function d(e,n){var t=N(n),r=t?"Field must not be empty":null;l((function(a){return Object(S.a)(Object(S.a)({},a),{},Object(z.a)({},e,{value:n,hasError:t,error:r}))}))}return Object(c.useEffect)((function(){var e=(null===r||void 0===r?void 0:r.id)||null,n=s.summary.value||"",t=s.description.value||"";a(function(e,n,t){return{id:e||Object(V.a)(),timestamp:Date.now(),summary:n.trim(),description:t,tags:[]}}(e,n,t))}),[s,null===r||void 0===r?void 0:r.id,a]),Object(J.jsxs)("form",{className:e.className,noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault()},children:[Object(J.jsx)("div",{children:Object(J.jsx)(Y,{label:"Summary",value:s.summary.value||"",onChange:function(e){return d("summary",e)},error:s.summary.error})}),Object(J.jsx)("div",{children:Object(J.jsx)(Y,{label:"Description",value:s.description.value||"",onChange:function(e){return d("description",e)},error:s.description.error,multiline:!0})})]})}))(W||(W=Object(T.a)(["\n  div {\n    width: 100%;\n  }\n\n  > div {\n    margin: ",";\n  }\n\n  > div > div > div > TextArea {\n    font-family: monospace;\n  }\n"])),(function(e){return e.theme.spacing(2,0,2)})));var _,ee=t(160),ne=t(161),te=Object(I.a)(Object(L.b)(re)(_||(_=Object(T.a)(["\n  position: fixed;\n  top: auto;\n  bottom: ","px;\n  left: auto;\n  right: 30px;\n"])),(function(e){return 30+70*(e.index||0)})));function re(e){return Object(J.jsx)(ee.a,{className:e.className,color:"primary","aria-label":"add",onClick:e.onClick,children:Object(J.jsx)(ne.a,{})})}re.defaultProps={onClick:function(){}};var ae,ce=t(168),ue=t(162),ie=t(163),oe=t(164),se=t(165),le=t(166),de=t(167),je=Object(I.a)(Object(L.b)(pe)(ae||(ae=Object(T.a)([""]))));function pe(e){return Object(J.jsx)(ce.a,{className:e.className,disabled:e.disabled,onClick:e.onClick,edge:e.edge,color:"inherit","aria-label":e.action,children:function(){switch(e.action){case"search":return Object(J.jsx)(ue.a,{});case"back":return Object(J.jsx)(ie.a,{});case"cancel":return Object(J.jsx)(oe.a,{});case"delete":return Object(J.jsx)(se.a,{});case"edit":return Object(J.jsx)(le.a,{});case"save":return Object(J.jsx)(de.a,{});default:return null}}()})}pe.defaultProps={disabled:!1,onClick:function(){}};var me,fe=t(169),be=t(170),ve=Object(I.a)(Object(L.b)((function(e){return Object(J.jsx)(fe.a,{className:e.className,position:"sticky",children:Object(J.jsxs)(be.a,{children:[e.primaryButton,Object(J.jsx)(A.a,{variant:"h6",children:e.title}),e.secondaryButton]})})}))(me||(me=Object(T.a)(["\n  flex-grow: 1;\n\n  & > div > h6 {\n    flex-grow: 1;\n  }\n"]))));var Oe,he=t(171),ge=Object(I.a)(Object(L.b)(xe)(Oe||(Oe=Object(T.a)(["\n  margin: ",";\n\n  > h6 {\n    margin: ",";\n  }\n"])),(function(e){return e.theme.spacing(0,0,15)}),(function(e){return e.theme.spacing(2,0,2)})));function xe(e){return Object(J.jsxs)(he.a,{className:e.className,maxWidth:!1,children:[null!==e.title&&Object(J.jsx)(A.a,{variant:"h6",children:e.title}),e.children]})}function ye(e){var n=e.useNavigation(),t=e.useEditorState((null===e||void 0===e?void 0:e.selectedDump)||null),r=Object(g.a)(t,2),a=r[0],c=r[1];function u(){a.saveDisabled||null===a.changedDump||e.onSave(a.changedDump)}return E(n.navigateHome),B((function(e){return e.ctrlKey&&"s"===e.key}),u),Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ve,{title:"Braindump",primaryButton:Object(J.jsx)(je,{action:"cancel",onClick:n.navigateHome,edge:"start"}),secondaryButton:Object(J.jsx)(je,{action:"save",disabled:a.saveDisabled,onClick:u,edge:"end"})}),Object(J.jsxs)(ge,{title:e.title,children:[Object(J.jsx)($,{dump:a.selectedDump,onChange:c}),null!==a.changedDump&&Object(J.jsx)(K,{dump:a.changedDump}),null!==a.selectedDump&&Object(J.jsx)(te,{onClick:n.navigateToCreate})]})]})}function De(e){var n=e.useNavigation(),t=e.useDispatch();return Object(J.jsx)(ye,{title:"Create new dump",onSave:function(e){t(function(e){return v(j.AddDump,e)}(e)),n.navigateToEdit(e)}})}function Ce(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Object.keys(n.map((function(e){return e.replace("'","")})).map((function(e){return e.toLowerCase()})).flatMap((function(e){return e.split(/[^a-z0-9]/)})).filter((function(e){return e.length>0})).reduce((function(e,n){return e[n]=!0,e}),{}))}function ke(e){return k((function(n){return n.dumps.find((function(n){return n.id===e}))||null}))}function we(e){var n=e.useDumpParam(),t=e.useNavigation(),r=e.useDumpByIdSelector(n.dumpId),a=e.useDispatch();function c(){null!==r&&t.navigateToEdit(r)}return E(t.navigateHome),B((function(e){return"e"===e.key}),c),Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ve,{title:"Braindump",primaryButton:Object(J.jsx)(je,{action:"back",onClick:t.navigateHome,edge:"start"}),secondaryButton:Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(je,{action:"edit",disabled:null===r,onClick:c,edge:"end"}),Object(J.jsx)(je,{action:"delete",disabled:null===r,onClick:function(){null!==r&&(a(b(r)),t.navigateHome())},edge:"end"})]})}),Object(J.jsxs)(ge,{children:[null!==r&&Object(J.jsx)(K,{dump:r}),Object(J.jsx)(te,{onClick:t.navigateToCreate})]})]})}function Se(e){var n=e.useDumpParam(),t=e.useDumpByIdSelector(n.dumpId),r=e.useDispatch();return Object(J.jsx)(ye,{title:"Edit dump",selectedDump:t,onSave:function(e){r(function(e){return v(j.UpdateDump,e)}(e))}})}xe.defaultProps={title:null},ye.defaultProps={useNavigation:d,useEditorState:function(e){var n=Object(c.useState)({selectedDump:e,changedDump:e,saveDisabled:!0}),t=Object(g.a)(n,2),r=t[0],a=t[1];function u(e,n){var t=!N(n.summary),r=!N(n.description),a=n.summary.trim()!==(null===e||void 0===e?void 0:e.summary),c=n.description!==(null===e||void 0===e?void 0:e.description);return t&&r&&(a||c)}return Object(c.useEffect)((function(){a({selectedDump:e,changedDump:e,saveDisabled:!0})}),[e]),[r,Object(c.useCallback)((function(e){a((function(n){return Object(S.a)(Object(S.a)({},n),{},{changedDump:e,saveDisabled:!u(n.selectedDump,e)})}))}),[])]}},De.defaultProps={useNavigation:d,useDispatch:w},we.defaultProps={useDumpParam:function(){return Object(l.g)()},useNavigation:d,useDumpByIdSelector:ke,useDispatch:function(){return Object(o.b)()}},Se.defaultProps={useDumpParam:function(){return Object(l.g)()},useDumpByIdSelector:ke,useDispatch:w};var Ne=t(51),Ee=t.n(Ne),Be=t(65);function Fe(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(Be.a)(Ee.a.mark((function e(n){return Ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return Te(n,e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e,n){var t=new FileReader;t.onload=function(){var e=function(e){if(null===e)return"";if(e instanceof ArrayBuffer)return(new TextDecoder).decode(e);return e}(t.result),r=JSON.parse(e);n(r)},t.readAsText(e)}var Ie=t(158),Re=t(183),Me=t(157),Ae=t(172);function Le(e){var n=Object(c.useState)(""),t=Object(g.a)(n,2),r=t[0],a=t[1],u=Object(c.useRef)();function i(n){var t;e.onChange(n),a(n),null===(t=u.current)||void 0===t||t.focus()}return E((function(){return i("")})),Object(J.jsxs)(Ie.a,{children:[Object(J.jsx)(Re.a,{htmlFor:"search",children:"Search"}),Object(J.jsx)(Me.a,{id:"search",inputRef:u,value:r,onChange:function(e){return i(e.target.value)},endAdornment:Object(J.jsx)(Ae.a,{position:"end",children:Object(J.jsx)(je,{action:""===r?"search":"cancel",onClick:function(){return i("")},edge:"end"})}),autoFocus:!0,autoComplete:"off"})]})}var He,Je=t(119),Ue=t(173),Ke=t(174),ze=t(159),Ve=Object(I.a)(Object(L.b)((function(e){var n=e.dumps.map((function(n){return Object(J.jsxs)(Je.a,{button:!0,onClick:function(){return e.onDumpSelection(n)},children:[Object(J.jsx)(Ue.a,{primary:n.summary,secondary:new Date(n.timestamp).toLocaleString()}),Object(J.jsx)(Ke.a,{onClick:function(){return e.onDumpRemoval(n)},children:Object(J.jsx)(ce.a,{edge:"end","aria-label":"delete",children:Object(J.jsx)(se.a,{})})})]},n.id)}));return Object(J.jsx)(ze.a,{children:n})}))(He||(He=Object(T.a)([""]))));var We,qe=t(175),Ge=t(91),Qe=t(176);function Xe(e){var n=Object(c.useState)(null),t=Object(g.a)(n,2),r=t[0],a=t[1],u=function(){a(null)},i=e.actions.map((function(e,n){return Object(J.jsx)(qe.a,{onClick:function(){return(0,e.action)(),void u()},children:e.title},"menu-item-".concat(n))}));return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ce.a,{onClick:function(e){a(e.currentTarget)},edge:"start",color:"inherit","aria-label":"menu",children:Object(J.jsx)(Qe.a,{})}),i.length>0&&Object(J.jsx)(Ge.a,{id:"app-menu",anchorEl:r,keepMounted:!0,open:!!r,onClose:u,children:i})]})}function Ye(e){var n=e.useNavigation(),t=Object(c.useState)({filter:"",selected:null}),r=Object(g.a)(t,2),a=r[0],u=r[1],i=e.useDumpByFilterSelector(a.filter),o=e.useDispatch(),s=Object(c.useRef)(null),l=function(){var e=Object(Be.a)(Ee.a.mark((function e(n){var t,r,a;return Ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=(null===(t=n.target.files)||void 0===t?void 0:t[0])||null)){e.next=6;break}return e.next=4,Fe(r);case 4:a=e.sent,o(f(a.dumps));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),d=[{title:"Export",action:function(){!function(e){var n=JSON.stringify(e),t=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.download="braindump.json",a.href=r,a.click()}(C.getState())}},{title:"Import",action:function(){var e;null===(e=s.current)||void 0===e||e.click()}}];return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ve,{title:"Braindump",primaryButton:Object(J.jsx)(Xe,{actions:d})}),Object(J.jsx)("input",{type:"file",ref:s,accept:"application/json, .json",onChange:l,style:{display:"none"}}),Object(J.jsxs)(ge,{title:"Find dumps",children:[Object(J.jsx)(Le,{onChange:function(e){u((function(n){return Object(S.a)(Object(S.a)({},n),{},{filter:e})}))}}),i.length>0&&Object(J.jsx)(Ve,{dumps:i,onDumpSelection:n.navigateToDetails,onDumpRemoval:function(e){o(b(e))}}),Object(J.jsx)(te,{onClick:n.navigateToCreate})]})]})}function Ze(){return Object(J.jsx)(s.a,{basename:"/braindump-app",children:Object(J.jsxs)(l.c,{children:[Object(J.jsx)(l.a,{path:"/create",children:Object(J.jsx)(De,{})}),Object(J.jsx)(l.a,{path:"/edit/dumps/:dumpId",children:Object(J.jsx)(Se,{})}),Object(J.jsx)(l.a,{path:"/show/dumps/:dumpId",children:Object(J.jsx)(we,{})}),Object(J.jsx)(l.a,{path:"/",children:Object(J.jsx)(Ye,{})})]})})}Ye.defaultProps={useDumpByFilterSelector:function(e){return k((function(n){var t=n.dumps.map((function(n){return function(e,n){var t=Ce.apply(void 0,[e.summary,e.description].concat(Object(x.a)(e.tags))),r=Ce(n);return function(e,n){var t=e.join(";");return n.filter((function(e){return t.includes(e)})).length}(t,r)}(n,e)}));return function(e,n){var t=Math.max.apply(Math,Object(x.a)(n));if(0===t)return[];return n.map((function(e,n){return e===t?n:-1})).filter((function(e){return e>=0})).map((function(n){return e[n]}))}(n.dumps,t)}))},useNavigation:d,useDispatch:w};var $e,_e,en=Object(L.a)(We||(We=Object(T.a)([""])));i.a.render(($e=Object(J.jsx)(Ze,{}),Object(J.jsxs)(c.StrictMode,{children:[Object(J.jsx)(r.a,{}),Object(J.jsxs)(a.b,{injectFirst:!0,children:[Object(J.jsx)(en,{}),Object(J.jsx)(o.a,{store:C,children:$e})]})]})),document.getElementById("root")),_e&&t.e(3).then(t.bind(null,184)).then((function(e){var n=e.getCLS,t=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;n(_e),t(_e),r(_e),a(_e),c(_e)}))}},[[118,1,2]]]);
//# sourceMappingURL=main.b3e1e0bc.chunk.js.map