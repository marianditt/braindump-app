(this["webpackJsonpbraindump-app"]=this["webpackJsonpbraindump-app"]||[]).push([[0],{118:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(11),c=t.n(a),u=t(53),i=t(14),o=t(20),s=t(48),l=t.n(s),d=t(60),j=t(17),f=t(181),p=t(77),b=t(10),m="dumps";function v(e){var n=JSON.stringify(e);window.localStorage.setItem(m,n)}var O="MERGE_DUMPS",h="ADD_DUMP",g="UPDATE_DUMP",x="REMOVE_DUMP";function y(e){var n={type:O,dumps:e};return function(e,t){e(n),v(t())}}function D(e,n){if(null===e)return n;var t=function(e,n){return e===n?[e,!1]:["".concat(e," --- ").concat(n),!0]}(e.summary,n.summary),r=Object(j.a)(t,2),a=r[0],c=r[1],u=function(e,n){return e===n?[e,!1]:["".concat(e,"\n\n---\n\n").concat(n),!0]}(e.description,n.description),i=Object(j.a)(u,2),o=i[0],s=i[1],l=c||s?"CONFLICT: ":"",d=new Map;return e.tags.forEach((function(e){return d.set(e,!0)})),n.tags.forEach((function(e){return d.set(e,!0)})),{id:e.id,summary:l+a,description:o,tags:Array.from(d.keys()),timestamp:Math.min(e.timestamp,n.timestamp)}}function C(e){var n={type:x,dump:e};return function(e,t){e(n),v(t())}}var k=function(){var e=window.localStorage.getItem(m);if(null===e)return[];try{return JSON.parse(e).dumps}catch(n){return[]}}();var w,S=t(42),E=Object(f.c)(Object(f.b)({dumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,n=arguments.length>1?arguments[1]:void 0;function t(n){var t=new Map;return e.forEach((function(e){return t.set(e.id,e)})),n.forEach((function(e){return t.set(e.id,D(t.get(e.id)||null,e))})),Array.from(t.values())}function r(e,n){return[].concat(Object(b.a)(e),[n])}function a(e,n){var t=e.findIndex((function(e){return e.id===n.id}));if(t<0)return e;var r=Object(b.a)(e);return r[t]=n,r}function c(e,n){return e.filter((function(e){return e.id!==n.id}))}switch(n.type){case O:var u=n;return t(u.dumps);case h:var i=n;return r(e,i.dump);case g:var o=n;return a(e,o.dump);case x:var s=n;return c(e,s.dump)}return e}}),Object(f.a)(p.a)),N=S.c,P=function(){return Object(S.b)()},B=t(162),T=t(183),F=t(163),M=t(164),I=t(161),R=t(15),A=t(153),L=t(156),U=t(157),H=t(158),J=t(159),_=t(182),K=t(160),V=t(16),z=t(2),G=Object(_.a)(Object(V.b)(W)(w||(w=Object(R.a)([""]))));function W(e){return Object(z.jsx)(K.a,{className:e.className,disabled:e.disabled,onClick:e.onClick,edge:e.edge,color:"inherit","aria-label":e.action,children:function(){switch(e.action){case"back":return Object(z.jsx)(A.a,{});case"cancel":return Object(z.jsx)(L.a,{});case"delete":return Object(z.jsx)(U.a,{});case"edit":return Object(z.jsx)(H.a,{});case"save":return Object(z.jsx)(J.a,{});default:return null}}()})}function q(e){var n=Object(r.useState)(""),t=Object(j.a)(n,2),a=t[0],c=t[1];function u(n){e.onChange(n),c(n)}return Object(z.jsxs)(B.a,{children:[Object(z.jsx)(T.a,{htmlFor:"search",children:"Search"}),Object(z.jsx)(F.a,{id:"search",value:a,onChange:function(e){return u(e.target.value)},endAdornment:Object(z.jsx)(M.a,{position:"end",children:""===a?Object(z.jsx)(I.a,{}):Object(z.jsx)(G,{action:"cancel",onClick:function(){return u("")},edge:"end"})}),autoFocus:!0,autoComplete:"off"})]})}W.defaultProps={disabled:!1,onClick:function(){}};var Q,X=t(119),Y=t(165),Z=t(166),$=t(167),ee=Object(_.a)(Object(V.b)((function(e){var n=e.dumps.map((function(n){return Object(z.jsxs)(X.a,{button:!0,onClick:function(){return e.onDumpSelection(n)},children:[Object(z.jsx)(Y.a,{primary:n.summary,secondary:new Date(n.timestamp).toLocaleString()}),Object(z.jsx)(Z.a,{onClick:function(){return e.onDumpRemoval(n)},children:Object(z.jsx)(K.a,{edge:"end","aria-label":"delete",children:Object(z.jsx)(U.a,{})})})]},n.id)}));return Object(z.jsx)($.a,{children:n})}))(Q||(Q=Object(R.a)([""]))));var ne,te=t(168),re=t(169),ae=t(57),ce=Object(_.a)(Object(V.b)((function(e){return Object(z.jsx)(te.a,{className:e.className,position:"sticky",children:Object(z.jsxs)(re.a,{children:[e.primaryButton,Object(z.jsx)(ae.a,{variant:"h6",children:e.title}),e.secondaryButton]})})}))(ne||(ne=Object(R.a)(["\n  flex-grow: 1;\n\n  & > div > h6 {\n    flex-grow: 1;\n  }\n"]))));var ue,ie=t(170),oe=t(91),se=t(171),le=Object(_.a)(Object(V.b)((function(e){var n=Object(r.useState)(null),t=Object(j.a)(n,2),a=t[0],c=t[1],u=function(){c(null)},i=e.actions.map((function(e,n){return Object(z.jsx)(ie.a,{onClick:function(){return(0,e.action)(),void u()},children:e.title},"menu-item-".concat(n))}));return Object(z.jsxs)("div",{className:e.className,children:[Object(z.jsx)(K.a,{onClick:function(e){c(e.currentTarget)},edge:"start",color:"inherit","aria-label":"menu",children:Object(z.jsx)(se.a,{})}),i.length>0&&Object(z.jsx)(oe.a,{id:"app-menu",anchorEl:a,keepMounted:!0,open:!!a,onClose:u,children:i})]})}))(ue||(ue=Object(R.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function de(e){return je.apply(this,arguments)}function je(){return(je=Object(d.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return fe(n,e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,n){var t=new FileReader;t.onload=function(){var e=function(e){if(null===e)return"";if(e instanceof ArrayBuffer)return(new TextDecoder).decode(e);return e}(t.result),r=JSON.parse(e);n(r)},t.readAsText(e)}var pe,be=t(172),me=t(173),ve=Object(_.a)(Object(V.b)(Oe)(pe||(pe=Object(R.a)(["\n  position: fixed;\n  top: auto;\n  bottom: ","px;\n  left: auto;\n  right: 30px;\n"])),(function(e){return 30+70*(e.index||0)})));function Oe(e){return Object(z.jsx)(be.a,{className:e.className,color:"primary","aria-label":"add",onClick:e.onClick,children:Object(z.jsx)(me.a,{})})}function he(){var e=Object(i.f)(),n=Object(r.useCallback)((function(n){"/"===e.location.pathname?e.push(n):e.replace(n)}),[e]);return{navigateHome:Object(r.useCallback)((function(){n("/")}),[n]),navigateToDetails:Object(r.useCallback)((function(e){n("/show/dumps/".concat(e.id))}),[n]),navigateToCreate:Object(r.useCallback)((function(){n("/create")}),[n]),navigateToEdit:Object(r.useCallback)((function(e){n("/edit/dumps/".concat(e.id))}),[n])}}Oe.defaultProps={onClick:function(){}};var ge,xe=t(174),ye=Object(_.a)(Object(V.b)(De)(ge||(ge=Object(R.a)(["\n  margin: ",";\n\n  > h6 {\n    margin: ",";\n  }\n"])),(function(e){return e.theme.spacing(0,0,15)}),(function(e){return e.theme.spacing(2,0,2)})));function De(e){return Object(z.jsxs)(xe.a,{className:e.className,maxWidth:!1,children:[null!==e.title&&Object(z.jsx)(ae.a,{variant:"h6",children:e.title}),e.children]})}function Ce(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Object.keys(n.map((function(e){return e.replace("'","")})).map((function(e){return e.toLowerCase()})).flatMap((function(e){return e.split(/[^a-z0-9]/)})).filter((function(e){return e.length>0})).reduce((function(e,n){return e[n]=!0,e}),{}))}function ke(e){return N((function(n){return n.dumps.find((function(n){return n.id===e}))||null}))}function we(e){var n=e.useNavigation(),t=Object(r.useState)({filter:"",selected:null}),a=Object(j.a)(t,2),c=a[0],u=a[1],i=e.useDumpByFilterSelector(c.filter),s=e.useDispatch(),f=Object(r.useRef)(null),p=function(){var e=Object(d.a)(l.a.mark((function e(n){var t,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=(null===(t=n.target.files)||void 0===t?void 0:t[0])||null)){e.next=6;break}return e.next=4,de(r);case 4:a=e.sent,s(y(a.dumps));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),b=[{title:"Export",action:function(){!function(e){var n=JSON.stringify(e),t=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.download="braindump.json",a.href=r,a.click()}(E.getState())}},{title:"Import",action:function(){var e;null===(e=f.current)||void 0===e||e.click()}}];return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(ce,{title:"Braindump",primaryButton:Object(z.jsx)(le,{actions:b})}),Object(z.jsx)("input",{type:"file",ref:f,accept:"application/json, .json",onChange:p,style:{display:"none"}}),Object(z.jsxs)(ye,{title:"Find dumps",children:[Object(z.jsx)(q,{onChange:function(e){u((function(n){return Object(o.a)(Object(o.a)({},n),{},{filter:e})}))}}),i.length>0&&Object(z.jsx)(ee,{dumps:i,onDumpSelection:n.navigateToDetails,onDumpRemoval:function(e){s(C(e))}}),Object(z.jsx)(ve,{onClick:n.navigateToCreate})]})]})}De.defaultProps={title:null},we.defaultProps={useDumpByFilterSelector:function(e){return N((function(n){var t=n.dumps.map((function(n){return function(e,n){var t=Ce.apply(void 0,[e.summary,e.description].concat(Object(b.a)(e.tags))),r=Ce(n);return function(e,n){var t=e.join(";");return n.filter((function(e){return t.includes(e)})).length}(t,r)}(n,e)}));return function(e,n){var t=Math.max.apply(Math,Object(b.a)(n));if(0===t)return[];return n.map((function(e,n){return e===t?n:-1})).filter((function(e){return e>=0})).map((function(n){return e[n]}))}(n.dumps,t)}))},useNavigation:he,useDispatch:P};var Se=t(7);function Ee(e){return 0===e.trim().length}var Ne=t(180);var Pe,Be=t(179),Te=function(){var e=new Map;return e.set("(",")"),e.set("[","]"),e.set("{","}"),e.set("<",">"),e.set('"','"'),e.set("'","'"),e}(),Fe=function(e){var n=new Map;return e.forEach((function(e,t){return n.set(e,t)})),n}(Te);function Me(e,n,t){return[e.slice(0,n),e.slice(n,t),e.slice(t)]}function Ie(e){var n=Object(r.useRef)(),t=Object(r.useState)(Re({value:e.value})),a=Object(j.a)(t,2),c=a[0],u=a[1];function i(n){u(n),e.onChange(n.value)}return Object(r.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.setSelectionRange(c.start,c.end,c.direction)}),[c]),Object(z.jsx)(Be.a,{inputRef:n,label:e.label,value:c.value,onKeyDown:function(n){var t=Re(n.target),r=e.enhancers.reduce((function(e,r){return e||r(n.key,t)}),null);null!==r&&(i(r),n.stopPropagation(),n.preventDefault())},onChange:function(e){return i(Re(e.target))},error:!!e.error,helperText:e.error||"",variant:"outlined",multiline:e.multiline})}function Re(e){return{value:e.value||"",start:e.selectionStart||0,end:e.selectionEnd||0,direction:e.selectionDirection||"none"}}Ie.defaultProps={label:"",value:"",onChange:function(){},error:null,multiline:!1,enhancers:[function(e,n){if("Backspace"!==e||n.start!==n.end)return null;var t=Me(n.value,n.start-1,n.start+1),r=Object(j.a)(t,3),a=r[0],c=r[1],u=r[2];return!!Te.get(c[0])&&!!Fe.get(c[1])?{value:a+u,start:a.length,end:a.length,direction:n.direction}:null},function(e,n){var t=n.value[n.start];return e!==t||n.start!==n.end?null:!!Fe.get(t)?{value:n.value,start:n.start+1,end:n.end+1,direction:n.direction}:null},function(e,n){var t=Te.get(e)||null;if(null===t)return null;var r=Me(n.value,n.start,n.end),a=Object(j.a)(r,3),c=a[0],u=a[1];return{value:c+e+u+t+a[2],start:c.length+1,end:c.length+1+u.length,direction:n.direction}}]};var Ae=Object(_.a)(Object(V.b)((function(e){var n,t,a=e.dump,c=e.onChange,u={summary:{value:(null===(n=e.dump)||void 0===n?void 0:n.summary)||null,error:null},description:{value:(null===(t=e.dump)||void 0===t?void 0:t.description)||null,error:null}},i=Object(r.useState)(u),s=Object(j.a)(i,2),l=s[0],d=s[1];function f(e,n){var t=Ee(n),r=t?"Field must not be empty":null;d((function(a){return Object(o.a)(Object(o.a)({},a),{},Object(Se.a)({},e,{value:n,hasError:t,error:r}))}))}return Object(r.useEffect)((function(){var e=(null===a||void 0===a?void 0:a.id)||null,n=l.summary.value||"",t=l.description.value||"";c(function(e,n,t){return{id:e||Object(Ne.a)(),timestamp:Date.now(),summary:n.trim(),description:t,tags:[]}}(e,n,t))}),[l,null===a||void 0===a?void 0:a.id,c]),Object(z.jsxs)("form",{className:e.className,noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault()},children:[Object(z.jsx)("div",{children:Object(z.jsx)(Ie,{label:"Summary",value:l.summary.value||"",onChange:function(e){return f("summary",e)},error:l.summary.error})}),Object(z.jsx)("div",{children:Object(z.jsx)(Ie,{label:"Description",value:l.description.value||"",onChange:function(e){return f("description",e)},error:l.description.error,multiline:!0})})]})}))(Pe||(Pe=Object(R.a)(["\n  div {\n    width: 100%;\n  }\n\n  > div {\n    margin: ",";\n  }\n\n  > div > div > div > TextArea {\n    font-family: monospace;\n  }\n"])),(function(e){return e.theme.spacing(2,0,2)})));function Le(e){Ue((function(e){return"Escape"===e.key}),e)}function Ue(e,n){function t(t){e(t)&&(n(),t.preventDefault())}Object(r.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}))}var He,Je,_e=t(175),Ke=t(176),Ve=t(90),ze=Object(_.a)(Object(V.b)((function(e){return Object(z.jsx)(Ve.a,{className:e.className,children:e.content})}))(He||(He=Object(R.a)(["\n  ",";\n\n  h1 {\n    ",";\n  }\n\n  h2 {\n    ",";\n  }\n\n  h3,\n  h4,\n  h5,\n  h6 {\n    ",";\n  }\n\n  img {\n    max-width: 100%;\n    max-height: 50vh;\n  }\n\n  *:not(pre) > code,\n  pre {\n    border: solid thin #d3d3d3;\n    border-radius: 5px;\n    background-color: #efefef;\n  }\n\n  *:not(pre) > code {\n    padding: 3px;\n  }\n\n  pre {\n    padding: ",";\n  }\n"])),(function(e){return e.theme.typography}),(function(e){return e.theme.typography.h4}),(function(e){return e.theme.typography.h5}),(function(e){return e.theme.typography.h6}),(function(e){return e.theme.spacing(1,1,1,1)})));var Ge=Object(_.a)(Object(V.b)((function(e){return Object(z.jsx)(_e.a,{className:e.className,children:Object(z.jsxs)(Ke.a,{children:[Object(z.jsx)(ae.a,{variant:"h6",children:e.dump.summary}),Object(z.jsx)(ze,{content:e.dump.description})]})})}))(Je||(Je=Object(R.a)(["\n  margin: ",";\n"])),(function(e){return e.theme.spacing(2,0,2)})));function We(e){var n=e.useNavigation(),t=e.useEditorState((null===e||void 0===e?void 0:e.selectedDump)||null),r=Object(j.a)(t,2),a=r[0],c=r[1];function u(){a.saveDisabled||null===a.changedDump||e.onSave(a.changedDump)}return Le(n.navigateHome),Ue((function(e){return e.ctrlKey&&"s"===e.key}),u),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(ce,{title:"Braindump",primaryButton:Object(z.jsx)(G,{action:"cancel",onClick:n.navigateHome,edge:"start"}),secondaryButton:Object(z.jsx)(G,{action:"save",disabled:a.saveDisabled,onClick:u,edge:"end"})}),Object(z.jsxs)(ye,{title:e.title,children:[Object(z.jsx)(Ae,{dump:a.selectedDump,onChange:c}),null!==a.changedDump&&Object(z.jsx)(Ge,{dump:a.changedDump}),null!==a.selectedDump&&Object(z.jsx)(ve,{onClick:n.navigateToCreate})]})]})}function qe(e){var n=e.useNavigation(),t=e.useDispatch();return Object(z.jsx)(We,{title:"Create new dump",onSave:function(e){t(function(e){var n={type:h,dump:e};return function(e,t){e(n),v(t())}}(e)),n.navigateToEdit(e)}})}function Qe(e){var n=e.useDumpParam(),t=e.useNavigation(),r=e.useDumpByIdSelector(n.dumpId),a=e.useDispatch();function c(){null!==r&&t.navigateToEdit(r)}return Le(t.navigateHome),Ue((function(e){return"e"===e.key}),c),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(ce,{title:"Braindump",primaryButton:Object(z.jsx)(G,{action:"back",onClick:t.navigateHome,edge:"start"}),secondaryButton:Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(G,{action:"edit",disabled:null===r,onClick:c,edge:"end"}),Object(z.jsx)(G,{action:"delete",disabled:null===r,onClick:function(){null!==r&&(a(C(r)),t.navigateHome())},edge:"end"})]})}),Object(z.jsxs)(ye,{children:[null!==r&&Object(z.jsx)(Ge,{dump:r}),Object(z.jsx)(ve,{onClick:t.navigateToCreate})]})]})}function Xe(e){var n=e.useDumpParam(),t=e.useDumpByIdSelector(n.dumpId),r=e.useDispatch();return Object(z.jsx)(We,{title:"Edit dump",selectedDump:t,onSave:function(e){r(function(e){var n={type:g,dump:e};return function(e,t){e(n),v(t())}}(e))}})}function Ye(){return Object(z.jsx)(u.a,{basename:"/braindump-app",children:Object(z.jsxs)(i.c,{children:[Object(z.jsx)(i.a,{path:"/create",children:Object(z.jsx)(qe,{})}),Object(z.jsx)(i.a,{path:"/edit/dumps/:dumpId",children:Object(z.jsx)(Xe,{})}),Object(z.jsx)(i.a,{path:"/show/dumps/:dumpId",children:Object(z.jsx)(Qe,{})}),Object(z.jsx)(i.a,{path:"/",children:Object(z.jsx)(we,{})})]})})}We.defaultProps={useNavigation:he,useEditorState:function(e){var n=Object(r.useState)({selectedDump:e,changedDump:e,saveDisabled:!0}),t=Object(j.a)(n,2),a=t[0],c=t[1];function u(e,n){var t=!Ee(n.summary),r=!Ee(n.description),a=n.summary.trim()!==(null===e||void 0===e?void 0:e.summary),c=n.description!==(null===e||void 0===e?void 0:e.description);return t&&r&&(a||c)}return Object(r.useEffect)((function(){c({selectedDump:e,changedDump:e,saveDisabled:!0})}),[e]),[a,Object(r.useCallback)((function(e){c((function(n){return Object(o.a)(Object(o.a)({},n),{},{changedDump:e,saveDisabled:!u(n.selectedDump,e)})}))}),[])]}},qe.defaultProps={useNavigation:he,useDispatch:P},Qe.defaultProps={useDumpParam:function(){return Object(i.g)()},useNavigation:he,useDumpByIdSelector:ke,useDispatch:function(){return Object(S.b)()}},Xe.defaultProps={useDumpParam:function(){return Object(i.g)()},useDumpByIdSelector:ke,useDispatch:P};var Ze,$e,en,nn=t(177),tn=t(178),rn=Object(V.a)(Ze||(Ze=Object(R.a)([""])));c.a.render(($e=Object(z.jsx)(Ye,{}),Object(z.jsxs)(r.StrictMode,{children:[Object(z.jsx)(nn.a,{}),Object(z.jsxs)(tn.b,{injectFirst:!0,children:[Object(z.jsx)(rn,{}),Object(z.jsx)(S.a,{store:E,children:$e})]})]})),document.getElementById("root")),en&&t.e(3).then(t.bind(null,184)).then((function(e){var n=e.getCLS,t=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;n(en),t(en),r(en),a(en),c(en)}))}},[[118,1,2]]]);
//# sourceMappingURL=main.02a4ac8f.chunk.js.map