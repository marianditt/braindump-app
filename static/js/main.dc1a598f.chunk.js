(this["webpackJsonpbraindump-app"]=this["webpackJsonpbraindump-app"]||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(11),c=n.n(a),i=n(54),u=n(14),o=n(10),s=n(19),l=n(48),d=n.n(l),j=n(61),b=n(26),m=n(178),p=n(76),f="dumps";function O(e){var t=JSON.stringify(e);window.localStorage.setItem(f,t)}var v="SET_DUMPS",h="ADD_DUMP",x="UPDATE_DUMP",g="REMOVE_DUMP";function y(e){var t={type:v,dumps:e};return function(e,n){e(t),O(n())}}var D=function(){var e=window.localStorage.getItem(f);if(null===e)return[];try{return JSON.parse(e).dumps}catch(t){return[]}}();var C=n(28),S=Object(m.c)(Object(m.b)({dumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;function n(e){return Object(o.a)(e)}function r(e,t){return[].concat(Object(o.a)(e),[t])}function a(e,t){var n=e.findIndex((function(e){return e.id===t.id}));if(n<0)return e;var r=Object(o.a)(e);return r[n]=t,r}function c(e,t){return e.filter((function(e){return e.id!==t.id}))}switch(t.type){case v:var i=t;return n(i.dumps);case h:var u=t;return r(e,u.dump);case x:var s=t;return a(e,s.dump);case g:var l=t;return c(e,l.dump)}return e}}),Object(m.a)(p.a)),E=C.c;function k(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object.keys(t.map((function(e){return e.replace("'","")})).map((function(e){return e.toLowerCase()})).flatMap((function(e){return e.split(/[^a-z0-9]/)})).filter((function(e){return e.length>0})).reduce((function(e,t){return e[t]=!0,e}),{}))}var w,N=n(15),T=n(179),B=n(153),F=n(157),P=n(180),I=n(158),M=n(118),L=n(159),A=n(160),H=n(161),R=n(163),U=n(16),J=n(156),W=n(162),_=n(2),V=Object(T.a)(Object(U.b)((function(e){var t=Object(_.jsx)(B.a,{position:"end",children:Object(_.jsx)(J.a,{})}),n=Object(_.jsxs)(F.a,{children:[Object(_.jsx)(P.a,{htmlFor:"search",children:"Search"}),Object(_.jsx)(I.a,{id:"search",autoFocus:!0,onChange:function(t){e.onSearchFilterChange(t.target.value)},endAdornment:t,autoComplete:"off"})]}),r=e.dumps.map((function(t){return Object(_.jsxs)(M.a,{button:!0,onClick:function(){return e.onDumpSelection(t)},children:[Object(_.jsx)(L.a,{primary:t.summary,secondary:new Date(t.timestamp).toLocaleString()}),Object(_.jsx)(A.a,{onClick:function(){return e.onDumpRemoval(t)},children:Object(_.jsx)(H.a,{edge:"end","aria-label":"delete",children:Object(_.jsx)(W.a,{})})})]},t.id)}));return Object(_.jsxs)(_.Fragment,{children:[n,e.dumps.length>0?Object(_.jsx)(R.a,{children:r}):null]})}))(w||(w=Object(N.a)([""]))));var z,K=n(164),q=n(165),G=n(58),Q=Object(T.a)(Object(U.b)((function(e){return Object(_.jsx)(K.a,{className:e.className,position:"sticky",children:Object(_.jsxs)(q.a,{children:[e.primaryButton,Object(_.jsx)(G.a,{variant:"h6",children:e.title}),e.secondaryButton]})})}))(z||(z=Object(N.a)(["\n  flex-grow: 1;\n\n  & > div > h6 {\n    flex-grow: 1;\n  }\n"]))));var X,Y=n(166),Z=n(90),$=n(167),ee=Object(T.a)(Object(U.b)((function(e){var t=Object(r.useState)(null),n=Object(b.a)(t,2),a=n[0],c=n[1],i=function(){c(null)},u=e.actions.map((function(e,t){return Object(_.jsx)(Y.a,{onClick:function(){return(0,e.action)(),void i()},children:e.title},"menu-item-".concat(t))}));return Object(_.jsxs)("div",{className:e.className,children:[Object(_.jsx)(H.a,{onClick:function(e){c(e.currentTarget)},edge:"start",color:"inherit","aria-label":"menu",children:Object(_.jsx)($.a,{})}),u.length>0&&Object(_.jsx)(Z.a,{id:"app-menu",anchorEl:a,keepMounted:!0,open:!!a,onClose:i,children:u})]})}))(X||(X=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return re(t,e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){var n=new FileReader;n.onload=function(){var e=function(e){if(null===e)return"";if(e instanceof ArrayBuffer)return(new TextDecoder).decode(e);return e}(n.result),r=JSON.parse(e);t(r)},n.readAsText(e)}var ae,ce=n(168),ie=n(169),ue=Object(T.a)(Object(U.b)(oe)(ae||(ae=Object(N.a)(["\n  position: fixed;\n  top: auto;\n  bottom: ","px;\n  left: auto;\n  right: 30px;\n"])),(function(e){return 30+70*(e.index||0)})));function oe(e){return Object(_.jsx)(ce.a,{className:e.className,color:"primary","aria-label":"add",onClick:e.onClick,children:Object(_.jsx)(ie.a,{})})}oe.defaultProps={onClick:function(){}};var se=n(170);function le(){var e=Object(u.f)();function t(t){"/"===e.location.pathname?e.push(t):e.replace(t)}return{navigateHome:function(){t("/")},navigateToDetails:function(t){e.push("/show/dumps/".concat(t.id))},navigateToCreate:function(){t("/create")},navigateToEdit:function(e){t("/edit/dumps/".concat(e.id))}}}function de(e){var t=e.useNavigation(),n=Object(r.useState)({filter:"",selected:null}),a=Object(b.a)(n,2),c=a[0],i=a[1],u=E((function(e){var t=e.dumps.map((function(e){return function(e,t){var n=k.apply(void 0,[e.summary,e.description].concat(Object(o.a)(e.tags))),r=k(t);return function(e,t){var n=e.join(";");return t.filter((function(e){return n.includes(e)})).length}(n,r)}(e,c.filter)}));return function(e,t){var n=Math.max.apply(Math,Object(o.a)(t));if(0===n)return[];return t.map((function(e,t){return e===n?t:-1})).filter((function(e){return e>=0})).map((function(t){return e[t]}))}(e.dumps,t)})),l=Object(C.b)(),m=Object(r.useRef)(null),p=function(){var e=Object(j.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=(null===(n=t.target.files)||void 0===n?void 0:n[0])||null)){e.next=6;break}return e.next=4,te(r);case 4:a=e.sent,l(y(a.dumps));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=[{title:"Export",action:function(){!function(e){var t=JSON.stringify(e),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.download="braindump.json",a.href=r,a.click()}(S.getState())}},{title:"Import",action:function(){var e;null===(e=m.current)||void 0===e||e.click()}}];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(ee,{actions:f})}),Object(_.jsx)("input",{type:"file",ref:m,accept:"application/json, .json",onChange:p,style:{display:"none"}}),Object(_.jsxs)(se.a,{maxWidth:!1,children:[Object(_.jsx)("h1",{children:"Find dumps"}),Object(_.jsx)(V,{dumps:u,onSearchFilterChange:function(e){i((function(t){return Object(s.a)(Object(s.a)({},t),{},{filter:e})}))},onDumpSelection:t.navigateToDetails,onDumpRemoval:function(e){l(function(e){var t={type:g,dump:e};return function(e,n){e(t),O(n())}}(e))}}),Object(_.jsx)(ue,{onClick:t.navigateToCreate})]})]})}de.defaultProps={useNavigation:le};var je=n(7),be=n(176);function me(e){return 0===e.trim().length}var pe,fe=n(177);var Oe=Object(T.a)(Object(U.b)((function(e){var t,n,a={summary:{value:(null===(t=e.dump)||void 0===t?void 0:t.summary)||null,hasError:!1,error:null},description:{value:(null===(n=e.dump)||void 0===n?void 0:n.description)||null,hasError:!1,error:null}},c=Object(r.useState)(a),i=Object(b.a)(c,2),u=i[0],o=i[1];function l(e,t){var n=me(t),r=n?"Field must not be empty":null;o((function(a){return Object(s.a)(Object(s.a)({},a),{},Object(je.a)({},e,{value:t,hasError:n,error:r}))}))}return Object(r.useEffect)((function(){var t,n=(null===(t=e.dump)||void 0===t?void 0:t.id)||null,r=u.summary.value||"",a=u.description.value||"";e.onChange(function(e,t,n){return{id:e||Object(fe.a)(),timestamp:Date.now(),summary:t.trim(),description:n,tags:[]}}(n,r,a))}),[u]),Object(_.jsxs)("form",{className:e.className,noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault()},children:[Object(_.jsx)("div",{children:Object(_.jsx)(be.a,{id:"summary",label:"Summary",variant:"outlined",value:u.summary.value||"",autoFocus:!0,onChange:function(e){return l("summary",e.target.value)},error:u.summary.hasError,helperText:u.summary.error})}),Object(_.jsx)("div",{children:Object(_.jsx)(be.a,{id:"description",label:"Description",variant:"outlined",value:u.description.value||"",multiline:!0,onChange:function(e){return l("description",e.target.value)},error:u.description.hasError,helperText:u.description.error})})]})}))(pe||(pe=Object(N.a)(["\n  div {\n    width: 100%;\n  }\n\n  > div {\n    margin: ",";\n  }\n\n  > div > div > div > TextArea {\n    font-family: monospace;\n  }\n"])),(function(e){return e.theme.spacing(2,0,2)})));var ve,he=n(171),xe=Object(T.a)(Object(U.b)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(H.a,{onClick:e.onCancel,edge:"start",color:"inherit","aria-label":"cancel",children:Object(_.jsx)(he.a,{})})})}))(ve||(ve=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function ge(e){De((function(e){return"Escape"===e.key}),e)}function ye(e){De((function(e){return e.ctrlKey&&"s"===e.key}),e)}function De(e,t){function n(n){e(n)&&(t(),n.preventDefault())}Object(r.useEffect)((function(){return document.addEventListener("keydown",n),function(){document.removeEventListener("keydown",n)}}))}function Ce(e){return E((function(t){return t.dumps.find((function(t){return t.id===e}))||null}))}function Se(e){var t=Ce(e),n=Object(r.useState)({selectedDump:t,changedDump:t,saveDisabled:!0}),a=Object(b.a)(n,2),c=a[0],i=a[1];function u(e,t){var n=!me(t.summary),r=!me(t.description),a=t.summary.trim()!==(null===e||void 0===e?void 0:e.summary),c=t.description!==(null===e||void 0===e?void 0:e.description);return n&&r&&(a||c)}return Object(r.useEffect)((function(){i({selectedDump:t,changedDump:t,saveDisabled:!0})}),[t]),[c,function(e){i((function(t){return Object(s.a)(Object(s.a)({},t),{},{changedDump:e,saveDisabled:!u(t.selectedDump,e)})}))}]}var Ee,ke=n(172),we=Object(T.a)(Object(U.b)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(H.a,{onClick:e.onSave,disabled:e.disabled,edge:"end",color:"inherit","aria-label":"save",children:Object(_.jsx)(ke.a,{})})})}))(Ee||(Ee=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function Ne(e){var t=e.useNavigation(),n=e.useEditorState(),r=Object(b.a)(n,2),a=r[0],c=r[1],i=e.useDispatch();function u(){a.saveDisabled||null===a.changedDump||(i(function(e){var t={type:h,dump:e};return function(e,n){e(t),O(n())}}(a.changedDump)),t.navigateToEdit(a.changedDump))}return ge(t.navigateHome),ye(u),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(xe,{onCancel:t.navigateHome}),secondaryButton:Object(_.jsx)(we,{disabled:a.saveDisabled,onSave:u})}),Object(_.jsxs)(se.a,{maxWidth:!1,children:[Object(_.jsx)("h1",{children:"Create new dump"}),Object(_.jsx)(Oe,{dump:a.selectedDump,onChange:c})]})]})}Ne.defaultProps={useNavigation:le,useEditorState:Se,useDispatch:function(){return Object(C.b)()}};var Te,Be=n(89),Fe=Object(T.a)(Object(U.b)((function(e){return Object(_.jsxs)("div",{className:e.className,children:[Object(_.jsx)("h1",{children:e.dump.summary}),Object(_.jsx)(Be.a,{children:e.dump.description})]})}))(Te||(Te=Object(N.a)(["\n  > div:last-child {\n    text-align: right;\n  }\n"]))));var Pe,Ie=n(173),Me=Object(T.a)(Object(U.b)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(H.a,{onClick:e.onEdit,edge:"end",color:"inherit","aria-label":"edit",children:Object(_.jsx)(Ie.a,{})})})}))(Pe||(Pe=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function Le(e){var t=e.useDumpParam(),n=e.useNavigation(),r=e.useDumpByIdSelector(t.dumpId);function a(){null!=r&&n.navigateToEdit(r)}return ge(n.navigateHome),De((function(e){return"e"===e.key}),a),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(xe,{onCancel:n.navigateHome}),secondaryButton:Object(_.jsx)(Me,{onEdit:a})}),Object(_.jsxs)(se.a,{maxWidth:!1,children:[null!==r&&Object(_.jsx)(Fe,{dump:r,onEdit:function(){return n.navigateToEdit(r)}}),Object(_.jsx)(ue,{onClick:n.navigateToCreate})]})]})}function Ae(e){var t=e.useDumpParam(),n=e.useNavigation(),r=e.useEditorState(t.dumpId),a=Object(b.a)(r,2),c=a[0],i=a[1],u=e.useDispatch();function o(){c.saveDisabled||null===c.changedDump||u(function(e){var t={type:x,dump:e};return function(e,n){e(t),O(n())}}(c.changedDump))}return ge(n.navigateHome),ye(o),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(xe,{onCancel:n.navigateHome}),secondaryButton:Object(_.jsx)(we,{disabled:c.saveDisabled,onSave:o})}),Object(_.jsxs)(se.a,{maxWidth:!1,children:[Object(_.jsx)("h1",{children:"Edit dump"}),Object(_.jsx)(Oe,{dump:c.selectedDump,onChange:i}),Object(_.jsx)(ue,{onClick:n.navigateToCreate})]})]})}function He(){return Object(_.jsx)(i.a,{basename:"/braindump-app",children:Object(_.jsxs)(u.c,{children:[Object(_.jsx)(u.a,{path:"/create",children:Object(_.jsx)(Ne,{})}),Object(_.jsx)(u.a,{path:"/edit/dumps/:dumpId",children:Object(_.jsx)(Ae,{})}),Object(_.jsx)(u.a,{path:"/show/dumps/:dumpId",children:Object(_.jsx)(Le,{})}),Object(_.jsx)(u.a,{path:"/",children:Object(_.jsx)(de,{})})]})})}Le.defaultProps={useDumpParam:function(){return Object(u.g)()},useNavigation:le,useDumpByIdSelector:Ce},Ae.defaultProps={useDumpParam:function(){return Object(u.g)()},useNavigation:le,useEditorState:Se,useDispatch:function(){return Object(C.b)()}};var Re,Ue,Je,We=n(174),_e=n(175),Ve=Object(U.a)(Re||(Re=Object(N.a)([""])));c.a.render((Ue=Object(_.jsx)(He,{}),Object(_.jsxs)(r.StrictMode,{children:[Object(_.jsx)(We.a,{}),Object(_.jsxs)(_e.b,{injectFirst:!0,children:[Object(_.jsx)(Ve,{}),Object(_.jsx)(C.a,{store:S,children:Ue})]})]})),document.getElementById("root")),Je&&n.e(3).then(n.bind(null,181)).then((function(e){var t=e.getCLS,n=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;t(Je),n(Je),r(Je),a(Je),c(Je)}))}},[[117,1,2]]]);
//# sourceMappingURL=main.dc1a598f.chunk.js.map