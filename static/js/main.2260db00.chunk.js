(this["webpackJsonpbraindump-app"]=this["webpackJsonpbraindump-app"]||[]).push([[0],{105:function(e,n,t){},120:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(11),c=t.n(a),i=(t(105),t(55)),u=t(14),o=t(10),s=t(19),l=t(49),d=t.n(l),j=t(62),m=t(27),b=t(181),f=t(78),p="dumps";function h(e){var n=JSON.stringify(e);window.localStorage.setItem(p,n)}var v="SET_DUMPS",O="ADD_DUMP",x="UPDATE_DUMP",g="REMOVE_DUMP";function y(e){var n={type:v,dumps:e};return function(e,t){e(n),h(t())}}var D=function(){var e=window.localStorage.getItem(p);if(null===e)return[];try{return JSON.parse(e).dumps}catch(n){return[]}}();var C=t(29),E=Object(b.c)(Object(b.b)({dumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,n=arguments.length>1?arguments[1]:void 0;function t(e){return Object(o.a)(e)}function r(e,n){return[].concat(Object(o.a)(e),[n])}function a(e,n){var t=e.findIndex((function(e){return e.id===n.id}));if(t<0)return e;var r=Object(o.a)(e);return r[t]=n,r}function c(e,n){return e.filter((function(e){return e.id!==n.id}))}switch(n.type){case v:var i=n;return t(i.dumps);case O:var u=n;return r(e,u.dump);case x:var s=n;return a(e,s.dump);case g:var l=n;return c(e,l.dump)}return e}}),Object(b.a)(f.a)),w=C.c;function k(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Object.keys(n.map((function(e){return e.replace("'","")})).map((function(e){return e.toLowerCase()})).flatMap((function(e){return e.split(/[^a-z0-9]/)})).filter((function(e){return e.length>0})).reduce((function(e,n){return e[n]=!0,e}),{}))}var S,N=t(17),T=t(182),B=t(156),F=t(160),P=t(183),I=t(161),L=t(121),M=t(162),A=t(163),R=t(164),U=t(166),H=t(18),J=t(159),W=t(165),_=t(2),V=Object(T.a)(Object(H.a)((function(e){var n=Object(_.jsx)(B.a,{position:"end",children:Object(_.jsx)(J.a,{})}),t=Object(_.jsxs)(F.a,{children:[Object(_.jsx)(P.a,{htmlFor:"search",children:"Search"}),Object(_.jsx)(I.a,{id:"search",autoFocus:!0,onChange:function(n){e.onSearchFilterChange(n.target.value)},endAdornment:n,autoComplete:"off"})]}),r=e.dumps.map((function(n){return Object(_.jsxs)(L.a,{button:!0,onClick:function(){return e.onDumpSelection(n)},children:[Object(_.jsx)(M.a,{primary:n.summary,secondary:new Date(n.timestamp).toLocaleString()}),Object(_.jsx)(A.a,{onClick:function(){return e.onDumpRemoval(n)},children:Object(_.jsx)(R.a,{edge:"end","aria-label":"delete",children:Object(_.jsx)(W.a,{})})})]},n.id)}));return Object(_.jsxs)(_.Fragment,{children:[t,e.dumps.length>0?Object(_.jsx)(U.a,{children:r}):null]})}))(S||(S=Object(N.a)([""]))));var z,K=t(167),q=t(168),G=t(59),Q=Object(T.a)(Object(H.a)((function(e){return Object(_.jsx)(K.a,{className:e.className,position:"sticky",children:Object(_.jsxs)(q.a,{children:[e.primaryButton,Object(_.jsx)(G.a,{variant:"h6",children:e.title}),e.secondaryButton]})})}))(z||(z=Object(N.a)(["\n  flex-grow: 1;\n\n  & > div > h6 {\n    flex-grow: 1;\n  }\n"]))));var X,Y=t(169),Z=t(92),$=t(170),ee=Object(T.a)(Object(H.a)((function(e){var n=Object(r.useState)(null),t=Object(m.a)(n,2),a=t[0],c=t[1],i=function(){c(null)},u=e.actions.map((function(e,n){return Object(_.jsx)(Y.a,{onClick:function(){return(0,e.action)(),void i()},children:e.title},"menu-item-".concat(n))}));return Object(_.jsxs)("div",{className:e.className,children:[Object(_.jsx)(R.a,{onClick:function(e){c(e.currentTarget)},edge:"start",color:"inherit","aria-label":"menu",children:Object(_.jsx)($.a,{})}),u.length>0?Object(_.jsx)(Z.a,{id:"app-menu",anchorEl:a,keepMounted:!0,open:!!a,onClose:i,children:u}):null]})}))(X||(X=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function ne(e){return te.apply(this,arguments)}function te(){return(te=Object(j.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return re(n,e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,n){var t=new FileReader;t.onload=function(){var e=function(e){if(null===e)return"";if(e instanceof ArrayBuffer)return(new TextDecoder).decode(e);return e}(t.result),r=JSON.parse(e);n(r)},t.readAsText(e)}var ae,ce=t(171),ie=t(172),ue=Object(T.a)(Object(H.a)((function(e){var n=e.onClick||function(){};return Object(_.jsx)(ce.a,{className:e.className,color:"primary","aria-label":"add",onClick:n,children:Object(_.jsx)(ie.a,{})})}))(ae||(ae=Object(N.a)(["\n  position: fixed;\n  top: auto;\n  bottom: ","px;\n  left: auto;\n  right: 30px;\n"])),(function(e){return 30+70*(e.index||0)})));var oe=t(173);function se(){var e=Object(u.f)();function n(n){"/"===e.location.pathname?e.push(n):e.replace(n)}return{navigateHome:function(){n("/")},navigateToDetails:function(n){e.push("/show/dumps/".concat(n.id))},navigateToCreate:function(){n("/create")},navigateToEdit:function(e){n("/edit/dumps/".concat(e.id))}}}function le(e){var n=e.useNavigation(),t=Object(r.useState)({filter:"",selected:null}),a=Object(m.a)(t,2),c=a[0],i=a[1],u=w((function(e){var n=e.dumps.map((function(e){return function(e,n){var t=k.apply(void 0,[e.summary,e.description].concat(Object(o.a)(e.tags))),r=k(n);return function(e,n){var t=e.join(";");return n.filter((function(e){return t.includes(e)})).length}(t,r)}(e,c.filter)}));return function(e,n){var t=Math.max.apply(Math,Object(o.a)(n));if(0===t)return[];return n.map((function(e,n){return e===t?n:-1})).filter((function(e){return e>=0})).map((function(n){return e[n]}))}(e.dumps,n)})),l=Object(C.b)(),b=Object(r.useRef)(null),f=function(){var e=Object(j.a)(d.a.mark((function e(n){var t,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=(null===(t=n.target.files)||void 0===t?void 0:t[0])||null)){e.next=6;break}return e.next=4,ne(r);case 4:a=e.sent,l(y(a.dumps));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),p=[{title:"Export",action:function(){!function(e){var n=JSON.stringify(e),t=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.download="braindump.json",a.href=r,a.click()}(E.getState())}},{title:"Import",action:function(){var e;null===(e=b.current)||void 0===e||e.click()}}];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(ee,{actions:p})}),Object(_.jsx)("input",{type:"file",ref:b,accept:"application/json, .json",onChange:f,style:{display:"none"}}),Object(_.jsxs)(oe.a,{maxWidth:!1,children:[Object(_.jsx)("h2",{children:"Find dumps"}),Object(_.jsx)(V,{dumps:u,onSearchFilterChange:function(e){i((function(n){return Object(s.a)(Object(s.a)({},n),{},{filter:e})}))},onDumpSelection:n.navigateToDetails,onDumpRemoval:function(e){l(function(e){var n={type:g,dump:e};return function(e,t){e(n),h(t())}}(e))}}),Object(_.jsx)(ue,{onClick:n.navigateToCreate})]})]})}le.defaultProps={useNavigation:se};var de=t(7),je=t(179);function me(e){return 0===e.trim().length}var be,fe=t(180);var pe=Object(T.a)(Object(H.a)((function(e){var n,t,a={summary:{value:(null===(n=e.dump)||void 0===n?void 0:n.summary)||null,hasError:!1,error:null},description:{value:(null===(t=e.dump)||void 0===t?void 0:t.description)||null,hasError:!1,error:null}},c=Object(r.useState)(a),i=Object(m.a)(c,2),u=i[0],o=i[1];function l(e,n){var t=me(n),r=t?"Field must not be empty":null;o((function(a){return Object(s.a)(Object(s.a)({},a),{},Object(de.a)({},e,{value:n,hasError:t,error:r}))}))}return Object(r.useEffect)((function(){var n,t=(null===(n=e.dump)||void 0===n?void 0:n.id)||null,r=u.summary.value||"",a=u.description.value||"";e.onChange(function(e,n,t){return{id:e||Object(fe.a)(),timestamp:Date.now(),summary:n.trim(),description:t,tags:[]}}(t,r,a))}),[u]),Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)("form",{className:e.className,noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault()},children:[Object(_.jsx)("div",{children:Object(_.jsx)(je.a,{id:"summary",label:"Summary",variant:"outlined",value:u.summary.value||"",autoFocus:!0,onChange:function(e){return l("summary",e.target.value)},error:u.summary.hasError,helperText:u.summary.error})}),Object(_.jsx)("div",{children:Object(_.jsx)(je.a,{id:"description",label:"Description",variant:"outlined",value:u.description.value||"",multiline:!0,rows:12,onChange:function(e){return l("description",e.target.value)},error:u.description.hasError,helperText:u.description.error})})]})})}))(be||(be=Object(N.a)(["\n  div {\n    width: 100%;\n  }\n\n  > div {\n    margin: ",";\n  }\n\n  > div:last-child {\n    text-align: right;\n  }\n\n  > div > div > div > TextArea {\n    font-family: monospace;\n  }\n"])),(function(e){return e.theme.spacing(2,0,2)})));var he,ve=t(174),Oe=Object(T.a)(Object(H.a)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(R.a,{onClick:e.onCancel,edge:"start",color:"inherit","aria-label":"cancel",children:Object(_.jsx)(ve.a,{})})})}))(he||(he=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));var xe=t(26),ge=t(68);function ye(e){return"e"===e.key}function De(e){return e.ctrlKey&&"s"===e.key}function Ce(e){return"Escape"===e.key}var Ee=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(xe.a)(this,e),this.handlers=n}return Object(ge.a)(e,[{key:"onEdit",value:function(e){return this.handlers.push({matcher:ye,action:e}),this}},{key:"onSave",value:function(e){return this.handlers.push({matcher:De,action:e}),this}},{key:"onCancel",value:function(e){return this.handlers.push({matcher:Ce,action:e}),this}},{key:"build",value:function(){var e=this;return function(n){var t=e.handlers.filter((function(e){return e.matcher(n)}));1===t.length&&(t[0].action(),n.preventDefault())}}}]),e}();function we(e){var n=(new Ee).onCancel(e).build();function t(e){n(e)}Object(r.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}))}function ke(e){var n=(new Ee).onSave(e).build();function t(e){n(e)}Object(r.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}))}function Se(e){return w((function(n){return n.dumps.find((function(n){return n.id===e}))||null}))}function Ne(e){var n=Se(e),t=Object(r.useState)({selectedDump:n,changedDump:n,saveDisabled:!0}),a=Object(m.a)(t,2),c=a[0],i=a[1];function u(e,n){var t=!me(n.summary),r=!me(n.description),a=n.summary.trim()!==(null===e||void 0===e?void 0:e.summary),c=n.description!==(null===e||void 0===e?void 0:e.description);return t&&r&&(a||c)}return Object(r.useEffect)((function(){i({selectedDump:n,changedDump:n,saveDisabled:!0})}),[n]),[c,function(e){i((function(n){return Object(s.a)(Object(s.a)({},n),{},{changedDump:e,saveDisabled:!u(n.selectedDump,e)})}))}]}var Te,Be=t(175),Fe=Object(T.a)(Object(H.a)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(R.a,{onClick:e.onSave,disabled:e.disabled,edge:"end",color:"inherit","aria-label":"save",children:Object(_.jsx)(Be.a,{})})})}))(Te||(Te=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function Pe(e){var n=e.useNavigation(),t=e.useEditorState(),r=Object(m.a)(t,2),a=r[0],c=r[1],i=e.useDispatch();function u(){null!==a.changedDump&&(i(function(e){var n={type:O,dump:e};return function(e,t){e(n),h(t())}}(a.changedDump)),n.navigateToEdit(a.changedDump))}return we(n.navigateHome),ke(u),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(Oe,{onCancel:n.navigateHome}),secondaryButton:Object(_.jsx)(Fe,{disabled:a.saveDisabled,onSave:u})}),Object(_.jsxs)(oe.a,{maxWidth:!1,children:[Object(_.jsx)("h1",{children:"Create new dump"}),Object(_.jsx)(pe,{dump:a.selectedDump,onChange:c})]})]})}Pe.defaultProps={useNavigation:se,useEditorState:Ne,useDispatch:function(){return Object(C.b)()}};var Ie,Le=t(91),Me=Object(T.a)(Object(H.a)((function(e){return Object(_.jsxs)("div",{className:e.className,children:[Object(_.jsx)("h2",{children:e.dump.summary}),Object(_.jsx)(Le.a,{children:e.dump.description})]})}))(Ie||(Ie=Object(N.a)(["\n  > div:last-child {\n    text-align: right;\n  }\n"]))));var Ae,Re=t(176),Ue=Object(T.a)(Object(H.a)((function(e){return Object(_.jsx)("div",{className:e.className,children:Object(_.jsx)(R.a,{onClick:e.onEdit,edge:"end",color:"inherit","aria-label":"edit",children:Object(_.jsx)(Re.a,{})})})}))(Ae||(Ae=Object(N.a)(["\n  button {\n    margin-right: ",";\n  }\n"])),(function(e){return e.theme.spacing(2)})));function He(e){var n=e.useDumpParam(),t=e.useNavigation(),a=e.useDumpByIdSelector(n.dumpId);function c(){null!=a&&t.navigateToEdit(a)}return function(e){var n=(new Ee).onEdit(e).build(),t=function(e){n(e)};Object(r.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}))}(c),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(Oe,{onCancel:t.navigateHome}),secondaryButton:Object(_.jsx)(Ue,{onEdit:c})}),Object(_.jsxs)(oe.a,{maxWidth:!1,children:[null!==a&&Object(_.jsx)(Me,{dump:a,onEdit:function(){return t.navigateToEdit(a)}}),Object(_.jsx)(ue,{onClick:t.navigateToCreate})]})]})}function Je(e){var n=e.useDumpParam(),t=e.useNavigation(),r=e.useEditorState(n.dumpId),a=Object(m.a)(r,2),c=a[0],i=a[1],u=e.useDispatch();function o(){null!==c.changedDump&&u(function(e){var n={type:x,dump:e};return function(e,t){e(n),h(t())}}(c.changedDump))}return we(t.navigateHome),ke(o),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Q,{title:"Braindump",primaryButton:Object(_.jsx)(Oe,{onCancel:t.navigateHome}),secondaryButton:Object(_.jsx)(Fe,{disabled:c.saveDisabled,onSave:o})}),Object(_.jsxs)(oe.a,{maxWidth:!1,children:[Object(_.jsx)("h1",{children:"Edit dump"}),Object(_.jsx)(pe,{dump:c.selectedDump,onChange:i}),Object(_.jsx)(ue,{onClick:t.navigateToCreate})]})]})}function We(){return Object(_.jsx)(i.a,{basename:"/braindump-app",children:Object(_.jsxs)(u.c,{children:[Object(_.jsx)(u.a,{path:"/create",children:Object(_.jsx)(Pe,{})}),Object(_.jsx)(u.a,{path:"/edit/dumps/:dumpId",children:Object(_.jsx)(Je,{})}),Object(_.jsx)(u.a,{path:"/show/dumps/:dumpId",children:Object(_.jsx)(He,{})}),Object(_.jsx)(u.a,{path:"/",children:Object(_.jsx)(le,{})})]})})}He.defaultProps={useDumpParam:function(){return Object(u.g)()},useNavigation:se,useDumpByIdSelector:Se},Je.defaultProps={useDumpParam:function(){return Object(u.g)()},useNavigation:se,useEditorState:Ne,useDispatch:function(){return Object(C.b)()}};var _e,Ve,ze=t(177),Ke=t(178);c.a.render((_e=Object(_.jsx)(We,{}),Object(_.jsxs)(r.StrictMode,{children:[Object(_.jsx)(ze.a,{}),Object(_.jsx)(Ke.b,{injectFirst:!0,children:Object(_.jsx)(C.a,{store:E,children:_e})})]})),document.getElementById("root")),Ve&&t.e(3).then(t.bind(null,184)).then((function(e){var n=e.getCLS,t=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;n(Ve),t(Ve),r(Ve),a(Ve),c(Ve)}))}},[[120,1,2]]]);
//# sourceMappingURL=main.2260db00.chunk.js.map